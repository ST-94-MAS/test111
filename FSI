EPELリポジトリの有効化
sudo amazon-linux-extras install epel

OpenSSL 1.1のインストール
sudo yum install -y openssl11


必要なライブラリのシンボリックリンク作成
sudo ln -s /usr/lib64/libssl.so.1.1 /usr/lib64/libssl.so.1.1
sudo ln -s /usr/lib64/libcrypto.so.1.1 /usr/lib64/libcrypto.so.1.1


Step 1: Zabbix Serverのインストール
パッケージリポジトリの追加

bash
コードをコピーする
sudo rpm -Uvh https://repo.zabbix.com/zabbix/6.0/rhel/7/x86_64/zabbix-release-6.0-2.el7.noarch.rpm
sudo yum clean all
sudo yum makecache

Zabbixサーバー、ウェブインターフェース、エージェントのインストール

bash
コードをコピーする
sudo yum install -y zabbix-server-pgsql zabbix-web-pgsql zabbix-agent
PostgreSQLのインストールと設定

bash
コードをコピーする
sudo amazon-linux-extras enable postgresql13
sudo yum install -y postgresql-server postgresql-contrib
sudo postgresql-setup initdb
sudo systemctl start postgresql
sudo systemctl enable postgresql

データベースの作成
PostgreSQLにログインします：

bash
コードをコピーする
sudo -u postgres psql
以下のコマンドを実行してデータベースとユーザーを作成します：

sql
コードをコピーする
CREATE DATABASE zabbix;
CREATE USER zabbix WITH PASSWORD 'password';
GRANT ALL PRIVILEGES ON DATABASE zabbix TO zabbix;
\q
データベース初期化スクリプトのインポート

bash
コードをコピーする
zcat /usr/share/doc/zabbix-server-pgsql*/create.sql.gz | sudo -u zabbix psql zabbix
Zabbixサーバーの設定
/etc/zabbix/zabbix_server.confファイルを編集します：

bash
コードをコピーする
sudo vi /etc/zabbix/zabbix_server.conf
以下の設定を行います：

makefile
コードをコピーする
DBPassword=password
PHP設定の変更
/etc/httpd/conf.d/zabbix.confファイルを編集します：

bash
コードをコピーする
sudo vi /etc/httpd/conf.d/zabbix.conf
以下の設定を行います：

lua
コードをコピーする
php_value date.timezone Asia/Tokyo
サービスの開始

bash
コードをコピーする
sudo systemctl restart zabbix-server zabbix-agent httpd
sudo systemctl enable zabbix-server zabbix-agent httpd
Step 2: Zabbixフロントエンドの設定
ブラウザでZabbixフロントエンドにアクセス
ZabbixサーバーのパブリックIPアドレスまたはDNS名にアクセスします：

arduino
コードをコピーする
http://<your-server-ip>/zabbix
インストールウィザードに従って設定

Step 3: 他のEC2インスタンスにZabbixエージェントをインストール
Zabbixエージェントのインストール
各監視対象のEC2インスタンスに以下のコマンドを実行します：

bash
コードをコピーする
sudo rpm -Uvh https://repo.zabbix.com/zabbix/6.0/rhel/7/x86_64/zabbix-release-6.0-2.el7.noarch.rpm
sudo yum clean all
sudo yum install -y zabbix-agent
Zabbixエージェントの設定
/etc/zabbix/zabbix_agentd.confファイルを編集します：

bash
コードをコピーする
sudo vi /etc/zabbix/zabbix_agentd.conf
以下の設定を行います：

arduino
コードをコピーする
Server=<ZabbixサーバーのIP>
サービスの開始

bash
コードをコピーする
sudo systemctl start zabbix-agent
sudo systemctl enable zabbix-agent
Step 4: Zabbixサーバーで監視対象を追加
Zabbixフロントエンドにログイン
「設定」 -> 「ホスト」 -> 「ホストの作成」
新しいホストの詳細を入力し、Zabbixエージェントを設定
